<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Multimorbidity clustering</title>
	<link href="https://fonts.googleapis.com/css?family=Open+Sans|Playfair+Display&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="v1-stylesheet.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body class='markdown-preview' data-use-github-style style="max-width: 1000px;margin: auto;">
	<header>
		<h1 style="text-align: center; font-size: 50px; margin: 0px; padding-top: 2%; background-color: white; ">Characterising clusters of multimorbidity</h1>
		<h3 style="text-align: center; margin: 0px; padding-bottom: 2%; padding-top: 2%; background-color: white; ">
			<a style="color:black; padding-right:1%;padding-left:1%;text-decoration: none;" href="index.html">Home</a>
			<a style="color:black; padding-right:1%;padding-left:1%;text-decoration: none;" href=#inprogress>Work in Progress</a>
	</header>
	<p style="text-align:center; padding-top:2%;margin:0px;"><img src="images/MEDCODE_CLUSTERS.jpg" alt="Disease clusters" style="width:600px;" /></p>
	<h4 style="text-align:center;margin: 0px;">Author: Thomas Beaney</h4>
	<p style="text-align:center;margin: 0px;"> Wellcome Clinical Research Fellow
	<p style="text-align:center;margin: 0px;">Imperial College London</p>
	<p style="text-align:center;margin: 0px;";href:"> <a href="https://tbeaney.github.io/index.html">Personal webpage </a> </p>
	<p style="text-align:center; margin: 0px;padding-bottom: 2%">
		<a style="padding-left:1%;padding-right:1%" href="mailto:thomas.beaney@imperial.ac.uk" target="_blank"><i class="material-icons" style="height:22px;vertical-align:middle">&#xe0be;</i></a>
		<a style="padding-left:1%;padding-right:1%" href="https://twitter.com/drtombeaney" target="_blank"><img src="images/twitter-logo.png" alt="Twitter" style="height:20px;vertical-align:middle"></a>
		<a style="padding-left:1%;padding-right:1%" href="https://www.linkedin.com/in/thomas-beaney-72388893" target="_blank"><img src="images/LI-logo.png" alt="Twitter" style="height:20px;vertical-align:middle"></a>

	<p>
		This site hosts resources related to research from my PhD on characterising multimorbidity clusters.
		Here you can access code lists used in the research, as well as results including interactive versions of published figures designed to help visualise the relationships between diseases.
		This website is a work in progress and will be updated as findings are developed.
	</p>

	<section id="background">
		<h2>Background</h2>
		<p>
			Multimorbidity, or the presence of multiple long-term conditions in one person is a growing priority for health systems.
			Healthcare has traditionally been designed around referral and treatment of single diseases, meaning that people with more than one disease often need to see multiple specialists who may have conflicting priorities regarding a person's management.
			There is a growing interest in defining groups of similar diseases or similar people, often referred to as 'clusters', with the hope that these might help identify shared causes between diseases, and shared opportunities for prevention and treatment.
		</p>

		<p>
			In my PhD, I aim firstly to develop clusters of both diseases and people based on patterns of how diseases co-occur.
			Secondly, I aim to explore the relationship between clusters of people with health outcomes (such as mortality) and healthcare utilisation (for example, whether a person is admitted to hospital).
			Disease clusters can help us to identify similarity between diseases, which can aid in understanding shared mechanisms of disease development.
			However, disease clusters are limited in terms of understanding relationships with outcomes and with healthcare use, and for this reason, I develop and focus on clusters of people.
		</p>

		<p>
			To determine the similarity between diseases and people, I adopt methods developed in natural language processing (NLP).
			These methods are designed for the analysis of sequences of words.
			In my PhD, I apply the same methods instead to sequences of diagnostic medical codes in the electronic healthcare record in general practice in England.
		</p>

	</section>


	<section id="inprogress">
		<h2>Work in progress</h2>
		<h3>Developing code lists</h3>
		<p>
			Most previous research on multimorbidity clusters have focussed on a small number of diseases (usually less than 20), which might miss relationships between diseases that are less common.
			In my research, I aim to use data-driven methods that allow for all codes indicating a disease/disorder to be included.
			However, there are tens of thousands of distinct disease codes, and in order to assess the interpretability of the codes, categorisation of codes is required.
			Others have used disease taxonomies or hierarchies, for example, chapters in the ICD-10 hierarchy of diseases.
			However, hierarchies such as ICD-10 are based on 'systems', for example the 'respiratory system', and so may link based on anatomical proximity (such as asthma and lung fibrosis), rather than aetiology.
			For my PhD, I use a set of 212 diseases defined previously in the literature.
			The original set of diseases were originally defined by Kuan and colleagues for the <a href="https://www.thelancet.com/journals/landig/article/PIIS2589-7500(19)30012-3/fulltext"> CALIBER study</a>,
			and available from the <a href="https://phenotypes.healthdatagateway.org"> HDRUK Phenotype Library </a>.
			Of the original 308 conditions, Head and colleagues selected 211 conditions relevant to multimorbidity for a <a href="https://www.thelancet.com/journals/lanhl/article/PIIS2666-7568(21)00146-X/fulltext"> study of multimorbidity incidence and prevalence</a>,
			with the code lists available on <a href="https://github.com/annalhead/CPRD_multimorbidity_codelists">GitHub</a>.
			These codes lists have been developed specifically for use in the <a href="https://cprd.com/primary-care-data-public-health-research">CPRD Aurum</a> dataset used in this study.
		</p>

		<p>
			I reviewed all codes in the original lists and made some edits to the codes.
			I also created a new category of 'Chronic Primary Pain', as a condition which is frequently included in studies of multimorbidity, but not included in the original CALIBER code lists.
			Where individual newly included conditions were already included in another category, for example Fibromyalgia included in 'Chronic Fatigue Syndrome', these conditions were removed.
			There were also changes to the codes included for diabetes, with removal of codes indicating a specific Type 1 or Type 2 diagnosis from the 'Other/unspecified' diabetes category.
		</p>

		<p>
			Link to download: [TBC]
		</p>


		<h3>Developing list of well-established disease associations</h3>
		<p>
			In order to interpet disease clusters, we developed a set of 253 established disease association pairs.
			The aim here is to provide a list of conditions which are clinically well-established to be associated with another, rather than an attempt to provide a comprehensive list of all possible associations.
			To create this list, I considered all 212 diseases, and used sources including the <a href="https://bestpractice.bmj.com/info/">BMJ Best Practice guidelines</a> to create a set of known disease associations for each disease, incorporating both known risk factors and known complications for a given disease.
			The set of disease pairs were reviewed by two co-authors with clinical backgrounds and any disagreements were discussed.
			A total of 144 conditions were included with at least one association to another disease.
		</p>

		<p>
			Link to download:
			<a href="resources/DISEASE_ASSOCIATION_PAIRS.csv" download="DISEASE_ASSOCIATION_PAIRS.csv">DISEASE_ASSOCIATION_PAIRS.csv</a>
		</p>


		<h3>Visualising disease embeddings</h3>
		<p>
			Multiple Correspondence Analysis (MCA) was used to create a vector representation of each disease, trialling retention of different numbers of dimensions.
			The link below shows the first two dimensions retained using MCA.
			More similar diseases appear closer together.
			Also overlaid on the plot are age category and the number of long-term conditions.
			As can be seen, age and number of conditions are strongly represented on the first dimension.
			Conditions common in younger people tend to separate from those more common in older people along dimension 1.
			Chronic liver conditions separate on dimension 2.
		</p>

		<p>
			<a href="mca_fig.html">Interactive plot of first two dimensions from MCA</a>
		</p>

		<h3>Defining clusters of diseases</h3>
		<p>
			Disease clusters were created using a three-step process.
			Firstly, vector representations ("disease embeddings") were created using a) MCA and b) NLP methods (<i>Word2vec</i> and <i>GloVe</i>)
			Secondly, similarity of each disease to each other disease was determined by calculating the cosine similarity, creating a 212 by 212 matrix.
			Thirdly, we clustered diseases based on their cosine similarity.
			We adopted a graph-based clustering algorithm, Markov Multiscale Community Detection (MMCD), available on <a href="https://github.com/barahona-research-group/PyGenStability">GitHub</a>.
		</p>

		<p>
			We created word cloud representations of the diseases, available for both MCA and Word2vec models below:

		<p>
			<a href="mca_clusters.html">MCA clusters</a>
		</p>
		<p>
			<a href="nlp_clusters.html">NLP clusters</a>

		</p>
	</section>

</body>
</html>